<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ title or "Seguros Lagun Aro" }}</title>
    <meta name="description" content="Landing de simulación de préstamo." />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&family=Playfair+Display:wght@500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}" />
  </head>
  <body>
    <div class="bg-gradient"></div>

    <header class="site-header">
      <div class="container header-inner">
        <a class="brand" href="{{ url_for('index') }}">
          <div
            class="animated-gradient-text with-border brand-logo"
            id="gradientText"
            data-direction="horizontal"
            data-speed="8"
            data-pause-on-hover="false"
            data-yoyo="true"
            data-colors="#5227FF,#FF9FFC,#B19EEF"
          >
            <div class="gradient-overlay"></div>
            <div class="text-content">Seguros Lagun Aro</div>
          </div>
        </a>
        <nav class="nav">
          <a href="{{ url_for('index') }}" class="nav-link">Inicio</a>
          <a href="{{ url_for('identificacion') }}" class="nav-link">Simulador</a>
          <a href="{{ url_for('historial') }}" class="nav-link">Historial</a>
        </nav>
      </div>
    </header>

    <main class="container">
      {% block content %}{% endblock %}
    </main>

    <footer class="site-footer">
      <div class="container footer-inner">
        <p>Seguros Lagun Aro · 2026</p>
        <p class="footer-note">Interfaz académica para el Reto 07.</p>
      </div>
    </footer>

    <div id="global-loading" class="loading-overlay" aria-hidden="true">
      <div class="loading" role="status" aria-live="polite" aria-label="Cargando">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </div>
      <p class="loading-text">Cargando...</p>
    </div>

    <script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
    <script src="https://unpkg.com/gsap@3/dist/ScrollTrigger.min.js"></script>
    <script>
      const globalLoader = document.getElementById("global-loading");

      const showLoader = () => {
        if (!globalLoader) return;
        globalLoader.classList.add("is-visible");
        globalLoader.setAttribute("aria-hidden", "false");
      };

      document.querySelectorAll("a[href]").forEach((link) => {
        const href = link.getAttribute("href");
        if (!href || href.startsWith("#") || href.startsWith("http")) {
          return;
        }
        link.addEventListener("click", (event) => {
          event.preventDefault();
          showLoader();
          setTimeout(() => {
            window.location.href = href;
          }, 1500);
        });
      });

      document.querySelectorAll("form").forEach((form) => {
        if (form.id === "simulador-form") return;
        form.addEventListener("submit", (event) => {
          event.preventDefault();
          showLoader();
          setTimeout(() => form.submit(), 1500);
        });
      });

      const revealBlocks = document.querySelectorAll(".scroll-reveal-text");
      if (revealBlocks.length) {
        gsap.registerPlugin(ScrollTrigger);
        revealBlocks.forEach((block) => {
          const words = block.textContent.trim().split(" ");
          block.innerHTML = words
            .map((word) => `<span class="word">${word}&nbsp;</span>`)
            .join("");

          gsap.fromTo(
            block.querySelectorAll(".word"),
            { opacity: 0.2, filter: "blur(6px)" },
            {
              opacity: 1,
              filter: "blur(0px)",
              stagger: 0.06,
              ease: "power2.out",
              scrollTrigger: {
                trigger: block,
                start: "top 85%",
                end: "bottom 60%",
                scrub: true,
              },
            }
          );
        });
      }
    </script>
  </body>
</html>
